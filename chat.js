let versesByMood = {
  sadness: [
    "أَمَا أَمَرْتُكَ؟ تَشَدَّدْ وَتَشَجَّعْ! لاَ تَرْهَبْ وَلاَ تَرْتَعِبْ لأَنَّ الرَّبَّ إِلهَكَ مَعَكَ حَيْثُمَا تَذْهَبُ. (يشوع 9:1)",
    "تَوَكَّلْ عَلَى الرَّبِّ بِكُلِّ قَلْبِكَ، وَعَلَى فَهْمِكَ لاَ تَعْتَمِدْ. (أمثال 5:3)",
    "فَقَالَ لِي: تَكْفِيكَ نِعْمَتِي، لأَنَّ قُوَّتِي فِي الضَّعفِ تُكْمَلُ. فَبِكُلِّ سُرُورٍ أَفْتَخِرُ بِالْحَرِيِّ فِي ضَعفَاتِي، لِكَيْ تَحِلَّ عَلَيَّ قُوَّةُ الْمَسِيحِ. (كورنثوس الثانية 9:12)",
    "مُلْقِينَ كُلَّ هَمِّكُمْ عَلَيْهِ، لأَنَّهُ هُوَ يَعْتَنِي بِكُمْ. (بطرس الأولى 7:5)"
  ],
  anxiety: [
    "لاَ تَخَفْ لأَنِّي مَعَكَ. لاَ تَتَلَفَّتْ لأَنِّي إِلهُكَ. قَدْ أَيَّدْتُكَ وَأَعَنْتُكَ وَعَضَدْتُكَ بِيَمِينِ بِرِّي. (إشعياء 10:41)",
    "وَلَكِنَّ اللهَ بَيَّنَ مَحَبَّتَهُ لَنَا، لأَنَّهُ وَنَحْنُ بَعْدُ خُطَاةٌ مَاتَ الْمَسِيحُ لأَجْلِنَا. (رومية 8:5)",
    "لأَنَّهُ هكَذَا أَحَبَّ اللهُ الْعَالَمَ حَتَّى بَذَلَ ابْنَهُ الْوَحِيدَ، لِكَيْ لاَ يَهْلِكَ كُلُّ مَنْ يُؤْمِنُ بِهِ، بَلْ تَكُونُ لَهُ الْحَيَاةُ الأَبَدِيَّةُ. (يوحنا 16:3)",
    "إِنِ اعْتَرَفْنَا بِخَطَايَانَا فَهُوَ أَمِينٌ وَعَادِلٌ، حَتَّى يَغْفِرَ لَنَا خَطَايَانَا وَيُطَهِّرَنَا مِنْ كُلِّ إِثْمٍ. (يوحنا الأولى 9:1)"
  ],
  tired: [
    "تَعَالَوْا إِلَيَّ يَا جَمِيعَ الْمُتْعَبِينَ وَالثَّقِيلِي الأَحْمَالِ، وَأَنَا أُرِيحُكُمْ. (متى 28:11)",
    "اَلْغِلْمَانُ يُعْيُونَ وَيَتْعَبُونَ، وَالْفِتْيَانُ يَتَعَثَّرُونَ تَعَثُّرًا. وَأَمَّا مُنْتَظِرُو الرَّبِّ فَيُجَدِّدُونَ قُوَّةً. يَرْفَعُونَ أَجْنِحَةً كَالنُّسُورِ. يَرْكُضُونَ وَلاَ يَتْعَبُونَ. يَمْشُونَ وَلاَ يُعْيُونَ. (إشعياء 30:40-31)",
    "لاَ تَهْتَمُّوا بِشَيْءٍ، بَلْفِي كُلِّ شَيْءٍ بِالصَّلاَةِ وَالدُّعَاءِ مَعَ الشُّكْرِ، لِتُعْعَمْ طِلْبَاتُكُمْ لَدَى اللهِ. (فيلبي 6:4)"
  ],
  stress: [
    "فَاذْهَبُوا وَتَلْمِذُوا جَمِيعَ الأُمَمِ وَعَمِّدُوهُمْ بِاسْمِ الآب وَالابْن وَالرُّوحِ الْقُدُسِ. وَعَلِّمُوهُمْ أَنْ يَحْفَظُوا جَمِيعَ مَا أَوْصَيْتُكُمْ بِهِ. وَهَا أَنَا مَعَكُمْ كُلَّ الأَيَّامِ إِلَى انْقِضَاءِ الدَّهْرِ. آمِينَ. (متى 19:28-20)",
    "قَالَ لَهُ يَسُوعُ: «أَنَا هُوَ الطَّرِيقُ وَالْحَقُّ وَالْحَيَاةُ. لَيْسَ أَحَدٌ يَأْتِي إِلَى الآبِ إِلاَّ بِي. (يوحنا 6:14)",
    "لأَنَّكُمْ بِالنِّعْمَةِ مُخَلَّصُونَ، بِالإِيمَانِ، وَذلِكَ لَيْسَ مِنْكُمْ. هُوَ عَطِيَّةُ اللهِ. لَيْسَ مِنْ أَعْمَال كَيْلاَ يَفْتَخِرَ أَحَدٌ. (أفسس 8:2-9)",
    "لأَنَّنَا نَحْنُ عَمَلُهُ، مَخْلُوقِينَ فِي الْمَسِيحِ يَسُوعَ لأَعْمَال صَالِحَةٍ، قَدْ سَبَقَ اللهُ فَأَعَدَّهَا لِكَيْ نَسْلُكَ فِيهَا. (أفسس 10:2)"
  ]
};

function sendChat() {
  const input = document.getElementById("chatInput").value.toLowerCase().trim();
  
  const keywords = {
    sadness: ["حزين", "ضيق", "مكسور", "حزن", "كئيب"],
    anxiety: ["قلق", "خايف", "توتر", "خائف", "مضطرب"],
    tired: ["تعب", "مرهق", "إرهاق", "خمول"],
    stress: ["ضغط", "مجهد", "مرتبك", "مشغول"]
  };

  function getRandomVerseFromArray(arr) {
    return arr[Math.floor(Math.random() * arr.length)];
  }

  let reply = "";

  // تحديد شعور المستخدم
  let matched = false;
  for (let mood in keywords) {
    if (keywords[mood].some(word => input.includes(word))) {
      reply = getRandomVerseFromArray(versesByMood[mood]);
      matched = true;
      break;
    }
  }

  // إذا المستخدم لم يدخل شيء
  if(input.length === 0) {
    reply = "اكتب شعورك لأتمكن من إرسال آية لك ❤️";
    matched = true;
  }

  // إذا لم يطابق أي شعور، نرسل آية عشوائية من كل الآيات
  if(!matched) {
    const allVerses = [].concat(...Object.values(versesByMood));
    reply = getRandomVerseFromArray(allVerses);
  }

  document.getElementById("chatResult").innerHTML = `<div class="card">${reply}</div>`;
}